(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[4576],{2866:function(e,s,r){(window.__NEXT_P=window.__NEXT_P||[]).push(["/servers/[server_id]/packages/install",function(){return r(1033)}])},1396:function(e,s,r){"use strict";r.d(s,{Cd:function(){return o},X:function(){return d},bZ:function(){return l}});var t=r(5893),a=r(7294),n=r(5139),c=r(7327);let i=(0,n.j)("relative w-full rounded-lg border p-4 [&:has(svg)]:pl-11 [&>svg+div]:translate-y-[-3px] [&>svg]:absolute [&>svg]:left-4 [&>svg]:top-4 [&>svg]:text-foreground",{variants:{variant:{default:"bg-background text-foreground",destructive:"border-destructive/50 text-destructive dark:border-destructive [&>svg]:text-destructive"}},defaultVariants:{variant:"default"}}),l=a.forwardRef((e,s)=>{let{className:r,variant:a,...n}=e;return(0,t.jsx)("div",{ref:s,role:"alert",className:(0,c.cn)(i({variant:a}),r),...n})});l.displayName="Alert";let o=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("h5",{ref:s,className:(0,c.cn)("mb-1 font-medium leading-none tracking-tight",r),...a})});o.displayName="AlertTitle";let d=a.forwardRef((e,s)=>{let{className:r,...a}=e;return(0,t.jsx)("div",{ref:s,className:(0,c.cn)("text-sm [&_p]:leading-relaxed",r),...a})});d.displayName="AlertDescription"},9827:function(e,s,r){"use strict";r.d(s,{C:function(){return i}});var t=r(5893);r(7294);var a=r(5139),n=r(7327);let c=(0,a.j)("inline-flex items-center rounded-full border px-2.5 py-0.5 text-xs font-semibold transition-colors focus:outline-none focus:ring-2 focus:ring-ring focus:ring-offset-2",{variants:{variant:{default:"border-transparent bg-primary text-primary-foreground hover:bg-primary/80",secondary:"border-transparent bg-secondary text-secondary-foreground hover:bg-secondary/80",destructive:"border-transparent bg-destructive text-destructive-foreground hover:bg-destructive/80",success:"border-transparent bg-green-500 text-white hover:bg-green-500/80",outline:"text-foreground"}},defaultVariants:{variant:"default"}});function i(e){let{className:s,variant:r,...a}=e;return(0,t.jsx)("div",{className:(0,n.cn)(c({variant:r}),s),...a})}},986:function(e,s,r){"use strict";r.d(s,{Z:function(){return c}});var t=r(5893),a=r(9008),n=r.n(a);function c(e){let{title:s,description:r,rightSide:a}=e;return(0,t.jsxs)("div",{className:"flex-1 flex-col p-8 md:flex",children:[(0,t.jsx)(n(),{children:(0,t.jsx)("title",{children:"".concat(s," | DZ")})}),(0,t.jsxs)("div",{className:"flex items-center justify-between space-y-2",children:[(0,t.jsxs)("div",{children:[(0,t.jsx)("h2",{className:"text-2xl font-bold tracking-tight",children:s}),(0,t.jsx)("p",{className:"text-muted-foreground",children:r})]}),a&&(0,t.jsx)("div",{className:"flex items-center",children:a})]})]})}},2592:function(e,s,r){"use strict";r.d(s,{E:function(){return i}});var t=r(5893),a=r(7294),n=r(7483),c=r(7327);let i=a.forwardRef((e,s)=>{let{className:r,value:a,...i}=e;return(0,t.jsx)(n.fC,{ref:s,className:(0,c.cn)("relative h-4 w-full overflow-hidden rounded-full bg-secondary",r),...i,children:(0,t.jsx)(n.z$,{className:"size-full flex-1 bg-primary transition-all",style:{transform:"translateX(-".concat(100-(a||0),"%)")}})})});i.displayName=n.fC.displayName},5050:function(e,s,r){"use strict";r.d(s,{p:function(){return n}}),r(7294);var t=r(7421),a=r(4712);function n(){let{t:e}=(0,t.$G)("common");return{toast:s=>{let{title:r,description:t,variant:n}=s,c={description:t,duration:6e3,dismissible:!0},i="";switch(r==e("information")?i="info":r==e("success")?i="success":r==e("error")?i="error":r==e("warning")&&(i="warning"),n&&(i=n),i){case"success":return a.A.success(r,c);case"error":case"destructive":return a.A.error(r,c);case"warning":return a.A.warning(r,c);case"info":return a.A.info(r,c);default:return(0,a.A)(r,c)}}}}},1033:function(e,s,r){"use strict";r.r(s),r.d(s,{default:function(){return A}});var t=r(5893),a=r(9774),n=r(3742),c=r(1352),i=r(5077),l=r(332),o=r(8814),d=r(7756),u=r(1163),g=r(7294),f=r(7421),p=r(2727),x=r(9827),m=r(7249),h=r(5282),v=r(2532),j=r(7622),_=r(986),b=r(3510),N=r(1396),y=r(733),k=r(5037),w=r(2592);let z=e=>{let{onSuccess:s}=e,{t:r}=(0,f.$G)("common"),{upload:a,setUpload:n,isUploading:c}=(0,p.hJ)({autoAbort:!0}),[i,l]=(0,g.useState)(0),[o,u]=(0,g.useState)(""),x={endpoint:"/upload",retryDelays:[0,1e3,3e3,5e3,1e4],overridePatchMethod:!0,chunkSize:1e6,onBeforeRequest:e=>new Promise(s=>{e.getUnderlyingObject().withCredentials=!0,s()}),onProgress:(e,s)=>{l(e/s*100)},onError:e=>{u(e.message)},headers:{Accept:"application/json"}},h=(0,g.useCallback)(e=>{var r;let t=null===(r=e.target.files)||void 0===r?void 0:r.item(0);t&&n(t,{...x,metadata:{filename:t.name,filetype:t.type},onSuccess:async function(e){var r;s(null===(r=e.url)||void 0===r?void 0:r.substring(e.url.lastIndexOf("/")+1))}})},[n]),v=(0,g.useCallback)(()=>{a&&a.start()},[a]);return(0,t.jsxs)("div",{className:"flex flex-col gap-3",children:[o&&(0,t.jsxs)(N.bZ,{children:[(0,t.jsx)(b.Z,{className:"size-4"}),(0,t.jsx)(N.Cd,{children:r("information")}),(0,t.jsx)(N.X,{children:o})]}),(0,t.jsx)(k.I,{type:"file",accept:".deb,.rpm",onChange:h}),(0,t.jsx)(w.E,{value:i,className:"h-[10px]"}),(0,t.jsx)("div",{className:"mt-5 flex justify-end",children:(0,t.jsxs)(m.z,{onClick:v,disabled:c,children:[c?(0,t.jsx)(y.P.spinner,{className:"mr-2 size-4 animate-spin"}):(0,t.jsx)(d.Z,{className:"mr-2 size-4"}),r("upload")]})})]})};var C=r(5050),Z=r(7327);function A(){let e=(0,u.useRouter)(),[s,r]=(0,g.useState)(!0),[d,j]=(0,g.useState)([]),{t:b,i18n:N}=(0,f.$G)("servers"),y=[{accessorKey:"data.path",header:e=>{let{column:s}=e;return(0,t.jsx)(v.p,{column:s,title:b("packages.accessor_path_title")})},title:b("packages.accessor_path_title"),accessorFn:e=>{let s=e.data.path;return s.substring(s.lastIndexOf("/")+1)}},{accessorKey:"status",header:e=>{let{column:s}=e;return(0,t.jsx)(v.p,{column:s,title:b("packages.accessor_status_title")})},title:b("packages.accessor_status_title"),accessorFn:e=>b("packages.status_".concat(e.status)),cell:e=>{let{row:s}=e,r=s.original.status,a="done"===r?"green":"failed"===r?"red":"pending"===r||"processing"===r?"yellow":"gray",o="done"===r?n.Z:"failed"===r?c.Z:"pending"===r?i.Z:l.Z;return(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)("div",{className:"".concat("processing"===r&&"animate-spin-slow"),children:(0,t.jsx)(o,{className:"text-".concat(a,"-500 size-4 ")})}),(0,t.jsx)(x.C,{className:"bg-".concat(a,"-500 hover:bg-").concat(a,"-700"),children:b("packages.status_".concat(r))})]})}},{accessorKey:"error",header:e=>{let{column:s}=e;return(0,t.jsx)(v.p,{column:s,title:b("packages.accessor_error_title")})},title:b("packages.accessor_error_title"),cell:e=>{let{row:s}=e,r=s.original.error;return r?(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(c.Z,{className:"size-4 text-red-500"}),(0,t.jsx)("span",{children:r})]}):(0,t.jsxs)("div",{className:"flex items-center gap-2",children:[(0,t.jsx)(n.Z,{className:"size-4 text-green-500"}),(0,t.jsx)("span",{children:b("packages.no_error")})]})},accessorFn:e=>e.error||b("packages.no_error")},{accessorKey:"updated_at",header:e=>{let{column:s}=e;return(0,t.jsx)(v.p,{column:s,title:b("packages.accessor_last_changed_title")})},title:b("packages.accessor_last_changed_title"),accessorFn:e=>new Date(e.updated_at).toLocaleDateString(N.language,{day:"2-digit",month:"long",year:"numeric",hour:"2-digit",minute:"2-digit"}),sortingFn:Z.aS}],k=()=>{e.query.server_id&&a.dJ.get("/servers/".concat(e.query.server_id,"/packages/queue")).then(e=>{j(e.data),r(!1)})};return(0,g.useEffect)(()=>{k();let e=setInterval(()=>{k()},1e4);return()=>clearInterval(e)},[e.query.server_id]),(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(_.Z,{title:b("packages.upload"),description:b("packages.page_header.description")}),(0,t.jsx)(h.Z,{columns:y,data:d,loading:s,selectable:!1,children:(0,t.jsxs)("div",{className:"flex gap-2",children:[(0,t.jsxs)(m.z,{variant:"outline",size:"sm",className:"ml-auto h-8 lg:flex",onClick:()=>e.back(),children:[(0,t.jsx)(o.Z,{className:"mr-2 size-4"}),b("packages.go_back")]}),(0,t.jsx)(p.kj,{children:(0,t.jsx)(S,{})})]})})]})}function S(){let[e,s]=(0,g.useState)(!1),{t:r}=(0,f.$G)("servers"),n=(0,u.useRouter)(),{toast:c}=(0,C.p)();return(0,t.jsxs)(j.Vq,{onOpenChange:e=>s(e),open:e,children:[(0,t.jsx)(j.hg,{asChild:!0,children:(0,t.jsxs)(m.z,{variant:"default",size:"sm",className:"ml-auto h-8 lg:flex",children:[(0,t.jsx)(d.Z,{className:"mr-2 size-4"}),r("packages.upload")]})}),(0,t.jsxs)(j.cZ,{className:"sm:max-w-[525px]",children:[(0,t.jsxs)(j.fK,{children:[(0,t.jsx)(j.$N,{children:r("packages.upload")}),(0,t.jsx)(j.Be,{children:r("packages.upload_description")})]}),(0,t.jsx)("div",{className:"mt-3 grid w-full items-center gap-1.5",children:(0,t.jsx)(z,{onSuccess:e=>{e&&a.dJ.post("/servers/".concat(n.query.server_id,"/packages/queue"),{file:e}).then(()=>{s(!1),c({title:r("success"),description:r("packages.upload_success")})}).catch(e=>{c({title:r("error"),description:e.response.data.file||e.response.data.message||e.response.data})})}})})]})]})}}},function(e){e.O(0,[5059,3265,7191,5855,2888,9774,179],function(){return e(e.s=2866)}),_N_E=e.O()}]);